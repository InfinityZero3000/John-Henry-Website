@model StoreManagementViewModel
@{
    ViewData["Title"] = "Quản lý cửa hàng";
    Layout = "~/Views/Shared/_SellerLayout.cshtml";
}

<div class="seller-modern">
    <div class="container-fluid">
        <!-- Page Header -->
        <div class="page-header mb-4">
            <div class="row align-items-center">
                <div class="col">
                    <div class="d-flex align-items-center mb-2">
                        <i data-lucide="store" class="me-2" style="width: 32px; height: 32px;"></i>
                        <div>
                            <h1 class="mb-0">Quản lý cửa hàng</h1>
                            <p class="text-muted small mb-0">Quản lý thông tin và hoạt động cửa hàng của bạn</p>
                        </div>
                    </div>
                </div>
                @if (Model.Store != null)
                {
                    <div class="col-auto">
                        <a href="@Url.Action("StoreSettings", "Seller")" class="btn btn-primary">
                            <i data-lucide="settings" class="me-2"></i>
                            Cài đặt cửa hàng
                        </a>
                    </div>
                }
            </div>
        </div>

        @if (Model.Store == null)
        {
            <!-- Empty State -->
            <div class="row justify-content-center">
                <div class="col-lg-6">
                    <div class="empty-state text-center py-5">
                        <div class="mb-4">
                            <i data-lucide="store" style="width: 120px; height: 120px; color: var(--bs-secondary);"></i>
                        </div>
                        <h3 class="mb-3">Chưa có cửa hàng</h3>
                        <p class="text-muted mb-4">Bạn chưa có cửa hàng nào. Hãy tạo cửa hàng để bắt đầu bán hàng và quản lý sản phẩm của bạn.</p>
                        <a href="@Url.Action("StoreSettings", "Seller")" class="btn btn-primary btn-lg">
                            <i data-lucide="plus" class="me-2"></i>
                            Tạo cửa hàng ngay
                        </a>
                    </div>
                </div>
            </div>
        }
        else
        {
            <div class="row g-4">
                <!-- Store Information Card -->
                <div class="col-lg-8">
                    <div class="filter-card">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4 class="mb-0">
                                <i data-lucide="info" class="me-2"></i>
                                Thông tin cửa hàng
                            </h4>
                            <a href="@Url.Action("StoreSettings", "Seller")" class="btn btn-outline-primary btn-sm">
                                <i data-lucide="edit" class="me-1"></i>
                                Chỉnh sửa
                            </a>
                        </div>
                        
                        <div class="row g-4">
                            <div class="col-md-6">
                                <div class="info-item">
                                    <label class="text-muted small mb-2 d-flex align-items-center">
                                        <i data-lucide="store" class="me-1" style="width: 16px; height: 16px;"></i>
                                        Tên cửa hàng
                                    </label>
                                    <div class="fw-semibold">@Model.Store.Name</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-item">
                                    <label class="text-muted small mb-2 d-flex align-items-center">
                                        <i data-lucide="toggle-right" class="me-1" style="width: 16px; height: 16px;"></i>
                                        Trạng thái
                                    </label>
                                    <div>
                                        @if (Model.Store.IsActive)
                                        {
                                            <span class="badge bg-success">
                                                <i data-lucide="check-circle" style="width: 14px; height: 14px;"></i>
                                                Đang hoạt động
                                            </span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-warning">
                                                <i data-lucide="pause-circle" style="width: 14px; height: 14px;"></i>
                                                Tạm dừng
                                            </span>
                                        }
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="info-item">
                                    <label class="text-muted small mb-2 d-flex align-items-center">
                                        <i data-lucide="file-text" class="me-1" style="width: 16px; height: 16px;"></i>
                                        Mô tả
                                    </label>
                                    <div class="text-muted">@(Model.Store.Description ?? "Chưa có mô tả")</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-item">
                                    <label class="text-muted small mb-2 d-flex align-items-center">
                                        <i data-lucide="map-pin" class="me-1" style="width: 16px; height: 16px;"></i>
                                        Địa chỉ
                                    </label>
                                    <div>@(Model.Store.Address ?? "Chưa cập nhật")</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-item">
                                    <label class="text-muted small mb-2 d-flex align-items-center">
                                        <i data-lucide="phone" class="me-1" style="width: 16px; height: 16px;"></i>
                                        Số điện thoại
                                    </label>
                                    <div>
                                        @if (!string.IsNullOrEmpty(Model.Store.Phone))
                                        {
                                            <a href="tel:@Model.Store.Phone" class="text-decoration-none">@Model.Store.Phone</a>
                                        }
                                        else
                                        {
                                            <span class="text-muted">Chưa cập nhật</span>
                                        }
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-item">
                                    <label class="text-muted small mb-2 d-flex align-items-center">
                                        <i data-lucide="mail" class="me-1" style="width: 16px; height: 16px;"></i>
                                        Email
                                    </label>
                                    <div>
                                        @if (!string.IsNullOrEmpty(Model.Store.Email))
                                        {
                                            <a href="mailto:@Model.Store.Email" class="text-decoration-none">@Model.Store.Email</a>
                                        }
                                        else
                                        {
                                            <span class="text-muted">Chưa cập nhật</span>
                                        }
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-item">
                                    <label class="text-muted small mb-2 d-flex align-items-center">
                                        <i data-lucide="clock" class="me-1" style="width: 16px; height: 16px;"></i>
                                        Giờ làm việc
                                    </label>
                                    <div>@(Model.Store.WorkingHours ?? "Chưa cập nhật")</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions Card -->
                    <div class="filter-card mt-4">
                        <h4 class="mb-4">
                            <i data-lucide="zap" class="me-2"></i>
                            Thao tác nhanh
                        </h4>
                        <div class="row g-3">
                            <div class="col-md-3 col-sm-6">
                                <a href="@Url.Action("Create", "SellerProducts")" class="quick-action-card text-decoration-none">
                                    <div class="icon-wrapper bg-primary bg-opacity-10 text-primary mb-3">
                                        <i data-lucide="plus"></i>
                                    </div>
                                    <div class="fw-semibold mb-1">Thêm sản phẩm</div>
                                    <small class="text-muted">Tạo sản phẩm mới</small>
                                </a>
                            </div>
                            <div class="col-md-3 col-sm-6">
                                <a href="@Url.Action("Index", "SellerProducts")" class="quick-action-card text-decoration-none">
                                    <div class="icon-wrapper bg-success bg-opacity-10 text-success mb-3">
                                        <i data-lucide="package"></i>
                                    </div>
                                    <div class="fw-semibold mb-1">Sản phẩm</div>
                                    <small class="text-muted">Quản lý sản phẩm</small>
                                </a>
                            </div>
                            <div class="col-md-3 col-sm-6">
                                <a href="@Url.Action("Orders", "Seller")" class="quick-action-card text-decoration-none">
                                    <div class="icon-wrapper bg-info bg-opacity-10 text-info mb-3">
                                        <i data-lucide="shopping-cart"></i>
                                    </div>
                                    <div class="fw-semibold mb-1">Đơn hàng</div>
                                    <small class="text-muted">Xử lý đơn hàng</small>
                                </a>
                            </div>
                            <div class="col-md-3 col-sm-6">
                                <a href="@Url.Action("Analytics", "Seller")" class="quick-action-card text-decoration-none">
                                    <div class="icon-wrapper bg-warning bg-opacity-10 text-warning mb-3">
                                        <i data-lucide="bar-chart-3"></i>
                                    </div>
                                    <div class="fw-semibold mb-1">Báo cáo</div>
                                    <small class="text-muted">Xem thống kê</small>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Store Statistics Sidebar -->
                <div class="col-lg-4">
                    <div class="filter-card">
                        <h4 class="mb-4">
                            <i data-lucide="bar-chart-2" class="me-2"></i>
                            Thống kê cửa hàng
                        </h4>
                        
                        <div class="stat-item mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="d-flex align-items-center">
                                    <div class="stat-icon bg-primary bg-opacity-10 text-primary me-3">
                                        <i data-lucide="package"></i>
                                    </div>
                                    <span class="text-muted">Tổng sản phẩm</span>
                                </div>
                                <span class="fw-bold fs-5">@Model.Statistics.TotalProducts</span>
                            </div>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-primary" style="width: 100%"></div>
                            </div>
                        </div>

                        <div class="stat-item mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="d-flex align-items-center">
                                    <div class="stat-icon bg-warning bg-opacity-10 text-warning me-3">
                                        <i data-lucide="alert-triangle"></i>
                                    </div>
                                    <span class="text-muted">Sắp hết kho</span>
                                </div>
                                <span class="fw-bold fs-5">@Model.Statistics.LowStockProducts</span>
                            </div>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-warning" style="width: @(Model.Statistics.TotalProducts > 0 ? (Model.Statistics.LowStockProducts * 100.0 / Model.Statistics.TotalProducts) : 0)%"></div>
                            </div>
                        </div>

                        <div class="stat-item mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="d-flex align-items-center">
                                    <div class="stat-icon bg-danger bg-opacity-10 text-danger me-3">
                                        <i data-lucide="x-circle"></i>
                                    </div>
                                    <span class="text-muted">Hết kho</span>
                                </div>
                                <span class="fw-bold fs-5">@Model.Statistics.OutOfStockProducts</span>
                            </div>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-danger" style="width: @(Model.Statistics.TotalProducts > 0 ? (Model.Statistics.OutOfStockProducts * 100.0 / Model.Statistics.TotalProducts) : 0)%"></div>
                            </div>
                        </div>

                        <div class="stat-item mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="d-flex align-items-center">
                                    <div class="stat-icon bg-info bg-opacity-10 text-info me-3">
                                        <i data-lucide="shopping-bag"></i>
                                    </div>
                                    <span class="text-muted">Đơn hàng tháng</span>
                                </div>
                                <span class="fw-bold fs-5">@Model.Statistics.MonthlyOrders</span>
                            </div>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-info" style="width: 75%"></div>
                            </div>
                        </div>

                        <div class="stat-item mb-0">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="d-flex align-items-center">
                                    <div class="stat-icon bg-success bg-opacity-10 text-success me-3">
                                        <i data-lucide="dollar-sign"></i>
                                    </div>
                                    <span class="text-muted">Doanh thu tháng</span>
                                </div>
                                <span class="fw-bold fs-5">@Model.Statistics.MonthlyRevenue.ToString("N0")đ</span>
                            </div>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-success" style="width: 65%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Store Staff Card (if applicable) -->
                    @if (Model.StoreStaff != null && Model.StoreStaff.Any())
                    {
                        <div class="filter-card mt-4">
                            <h4 class="mb-4">
                                <i data-lucide="users" class="me-2"></i>
                                Nhân viên (@Model.Statistics.StaffCount)
                            </h4>
                            <div class="list-group list-group-flush">
                                @foreach (var staff in Model.StoreStaff.Take(5))
                                {
                                    <div class="list-group-item px-0">
                                        <div class="d-flex align-items-center">
                                            <div class="avatar-circle bg-primary text-white me-3">
                                                @(staff.Seller?.UserName?.Substring(0, 1).ToUpper() ?? "?")
                                            </div>
                                            <div class="flex-grow-1">
                                                <div class="fw-semibold">@(staff.Seller?.UserName ?? "Unknown")</div>
                                                <small class="text-muted">@staff.Role</small>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                            @if (Model.StoreStaff.Count > 5)
                            {
                                <div class="text-center mt-3">
                                    <a href="#" class="text-decoration-none small">Xem tất cả (@Model.StoreStaff.Count)</a>
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>

        }
    </div>
</div>

<style>
    .quick-action-card {
        display: block;
        padding: 1.5rem;
        border-radius: 12px;
        background: white;
        border: 1px solid #e9ecef;
        transition: all 0.3s ease;
        text-align: center;
    }

    .quick-action-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        border-color: var(--bs-primary);
    }

    .quick-action-card .icon-wrapper {
        width: 56px;
        height: 56px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto;
    }

    .quick-action-card .icon-wrapper i {
        width: 28px;
        height: 28px;
    }

    .stat-item .stat-icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .stat-item .stat-icon i {
        width: 20px;
        height: 20px;
    }

    .avatar-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
    }

    .info-item {
        padding: 0.75rem 0;
    }

    .info-item label {
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
</style>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Lucide icons
            lucide.createIcons();
        });
    </script>
}