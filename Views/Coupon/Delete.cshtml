@model JohnHenryFashionWeb.Models.Coupon
@{
    ViewData["Title"] = "Xác nhận xóa mã giảm giá";
    ViewData["CurrentSection"] = "Coupons";
    ViewData["PageIcon"] = "trash-2";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="admin-content">
    <!-- Page Header -->
    <div class="admin-page-header">
        <div class="admin-page-header-content">
            <h1 class="admin-page-title">
                <i data-lucide="alert-triangle" style="color: var(--admin-danger);"></i>
                Xác nhận xóa mã giảm giá
            </h1>
            <p class="admin-page-subtitle">Bạn đang thực hiện xóa mã <code class="admin-code">@Model.Code</code></p>
        </div>
        <div class="admin-page-header-actions">
            <a href="/Coupon/Manage" class="admin-btn admin-btn-secondary">
                <i data-lucide="arrow-left"></i>
                Quay lại
            </a>
        </div>
    </div>

    <!-- Content -->
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="admin-card" style="border-left: 4px solid var(--admin-danger);">
                <div class="admin-card-header" style="background-color: rgba(220, 53, 69, 0.1);">
                    <h5 class="admin-card-title" style="color: var(--admin-danger);">
                        <i data-lucide="alert-triangle"></i>
                        Cảnh báo xóa dữ liệu
                    </h5>
                </div>
                <div class="admin-card-body">
                    <div class="admin-alert admin-alert-warning">
                        <i data-lucide="alert-triangle"></i>
                        <div>
                            <strong>Cảnh báo!</strong>
                            <p style="margin: 0.5rem 0 0;">Hành động này không thể hoàn tác. Tất cả dữ liệu liên quan đến mã giảm giá này sẽ bị xóa vĩnh viễn.</p>
                        </div>
                    </div>
                    
                    <h6 style="margin: 2rem 0 1rem; font-weight: 600;">Thông tin mã giảm giá sẽ bị xóa:</h6>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="admin-label">Mã giảm giá</label>
                                <div><code class="admin-code" style="font-size: 1.1em;">@Model.Code</code></div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="admin-label">Tên</label>
                                <div>@Model.Name</div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="admin-label">Loại giảm giá</label>
                                <div>
                                    @if (Model.Type == "percentage")
                                    {
                                        <span>Phần trăm (@Model.Value%)</span>
                                    }
                                    else
                                    {
                                        <span>Số tiền cố định (@Model.Value.ToString("N0") VNĐ)</span>
                                    }
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="admin-label">Trạng thái</label>
                                <div>
                                    @if (Model.IsActive)
                                    {
                                        <span class="admin-badge admin-badge-success">
                                            <i data-lucide="check-circle"></i>
                                            Đang hoạt động
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="admin-badge admin-badge-secondary">
                                            <i data-lucide="pause-circle"></i>
                                            Tạm dừng
                                        </span>
                                    }
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="admin-label">Đã sử dụng</label>
                                <div style="font-weight: 600;">@Model.UsageCount lần</div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="admin-label">Giới hạn sử dụng</label>
                                <div>
                                    @if (Model.UsageLimit.HasValue)
                                    {
                                        @Model.UsageLimit.Value.ToString("N0") <text>lần</text>
                                    }
                                    else
                                    {
                                        <em class="text-muted">Không giới hạn</em>
                                    }
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="admin-label">Ngày tạo</label>
                                <div>@Model.CreatedAt.ToString("dd/MM/yyyy HH:mm")</div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="admin-label">Cập nhật lần cuối</label>
                                <div>@Model.UpdatedAt.ToString("dd/MM/yyyy HH:mm")</div>
                            </div>
                        </div>
                    </div>
                    
                    @if (Model.UsageCount > 0)
                    {
                        <div class="admin-alert admin-alert-info" style="margin-top: 1.5rem;">
                            <i data-lucide="info"></i>
                            <div>
                                <strong>Lưu ý:</strong>
                                <p style="margin: 0.5rem 0 0;">Mã giảm giá này đã được sử dụng <strong>@Model.UsageCount lần</strong>. Việc xóa có thể ảnh hưởng đến lịch sử đơn hàng và báo cáo thống kê.</p>
                            </div>
                        </div>
                    }
                </div>
                
                <div class="admin-card-footer" style="background-color: rgba(220, 53, 69, 0.05);">
                    <form asp-action="Delete" method="post" class="d-inline">
                        <input asp-for="Id" type="hidden" />
                        <button type="submit" class="admin-btn admin-btn-danger" 
                                onclick="return confirm('Bạn có CHẮC CHẮN muốn xóa mã giảm giá này không?\n\nHành động này không thể hoàn tác!')">
                            <i data-lucide="trash-2"></i>
                            Xác nhận xóa
                        </button>
                    </form>
                    
                    <a href="/Coupon/Details?id=@Model.Id" class="admin-btn admin-btn-secondary">
                        <i data-lucide="eye"></i>
                        Xem chi tiết
                    </a>
                    
                    <a href="/Coupon/Manage" class="admin-btn admin-btn-secondary">
                        <i data-lucide="x"></i>
                        Hủy bỏ
                    </a>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4">
            <div class="admin-card" style="border-left: 4px solid var(--admin-warning);">
                <div class="admin-card-header" style="background-color: rgba(255, 193, 7, 0.1);">
                    <h5 class="admin-card-title">
                        <i data-lucide="lightbulb"></i>
                        Các tùy chọn khác
                    </h5>
                </div>
                <div class="admin-card-body">
                    <p style="font-weight: 500; margin-bottom: 1rem;">Thay vì xóa, bạn có thể:</p>
                    
                    <div class="d-grid gap-2">
                        <a href="/Coupon/ToggleStatus?id=@Model.Id" class="admin-btn admin-btn-warning" style="justify-content: center;">
                            <i data-lucide="pause"></i>
                            Tạm dừng mã giảm giá
                        </a>
                        
                        <a href="/Coupon/Edit?id=@Model.Id" class="admin-btn admin-btn-primary" style="justify-content: center;">
                            <i data-lucide="edit"></i>
                            Chỉnh sửa thông tin
                        </a>
                    </div>
                    
                    <hr style="margin: 1.5rem 0;">
                    
                    <div class="admin-alert admin-alert-info" style="margin: 0;">
                        <i data-lucide="info"></i>
                        <div>
                            <strong>Gợi ý:</strong>
                            <p style="margin: 0.5rem 0 0; font-size: 0.875rem;">Tạm dừng mã giảm giá sẽ giữ lại toàn bộ dữ liệu và có thể kích hoạt lại bất cứ lúc nào.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Initialize Lucide icons
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });
    </script>
}
