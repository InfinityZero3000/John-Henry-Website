# H∆Ø·ªöNG D·∫™N KI·ªÇM TRA V√Ä C·∫¢I TI·∫æN H·ªÜ TH·ªêNG SELLER

## Ng√†y t·∫°o: 10/11/2025

## üìã T·ªîNG QUAN

T√†i li·ªáu n√†y m√¥ t·∫£ c√°c ch·ª©c nƒÉng c·ªßa Seller trong h·ªá th·ªëng John Henry Fashion, c√°c v·∫•n ƒë·ªÅ hi·ªán t·∫°i c·∫ßn kh·∫Øc ph·ª•c, v√† danh s√°ch c√°c c·∫£i ti·∫øn c·∫ßn th·ª±c hi·ªán.

---

## üéØ C√ÅC CH·ª®C NƒÇNG CH√çNH C·ª¶A SELLER

### 1. **Dashboard (Trang ch·ªß Seller)**
- ‚úÖ Hi·ªÉn th·ªã th·ªëng k√™ t·ªïng quan:
  - S·ªë l∆∞·ª£ng s·∫£n ph·∫©m c·ªßa seller
  - S·ªë l∆∞·ª£ng ƒë∆°n h√†ng
  - Doanh thu t·ªïng
  - Doanh thu th√°ng hi·ªán t·∫°i
- ‚úÖ Hi·ªÉn th·ªã 5 ƒë∆°n h√†ng g·∫ßn nh·∫•t
- ‚úÖ Hi·ªÉn th·ªã top 5 s·∫£n ph·∫©m b√°n ch·∫°y
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Hi·ªán t·∫°i ƒëang hi·ªÉn th·ªã T·∫§T C·∫¢ s·∫£n ph·∫©m/ƒë∆°n h√†ng trong h·ªá th·ªëng, ch∆∞a l·ªçc theo seller c·ª• th·ªÉ

### 2. **Qu·∫£n l√Ω S·∫£n ph·∫©m**
- ‚úÖ Xem danh s√°ch s·∫£n ph·∫©m (c√≥ ph√¢n trang, t√¨m ki·∫øm, l·ªçc)
- ‚úÖ Th√™m s·∫£n ph·∫©m m·ªõi
- ‚úÖ Ch·ªânh s·ª≠a s·∫£n ph·∫©m
- ‚úÖ X√≥a s·∫£n ph·∫©m
- ‚úÖ Upload h√¨nh ·∫£nh s·∫£n ph·∫©m
- ‚úÖ Qu·∫£n l√Ω tr·∫°ng th√°i s·∫£n ph·∫©m (active/inactive)
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch∆∞a c√≥ c·ªôt `SellerId` trong b·∫£ng `Products` ƒë·ªÉ li√™n k·∫øt s·∫£n ph·∫©m v·ªõi seller

### 3. **Qu·∫£n l√Ω ƒê∆°n h√†ng**
- ‚úÖ Xem danh s√°ch ƒë∆°n h√†ng (c√≥ ph√¢n trang, t√¨m ki·∫øm, l·ªçc)
- ‚úÖ Xem chi ti·∫øt ƒë∆°n h√†ng
- ‚úÖ C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Hi·ªán t·∫°i hi·ªÉn th·ªã T·∫§T C·∫¢ ƒë∆°n h√†ng, ch∆∞a l·ªçc theo s·∫£n ph·∫©m c·ªßa seller

### 4. **Qu·∫£n l√Ω T·ªìn kho**
- ‚úÖ Xem danh s√°ch t·ªìn kho
- ‚úÖ C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng t·ªìn kho
- ‚úÖ C·∫£nh b√°o s·∫£n ph·∫©m s·∫Øp h·∫øt h√†ng (quantity <= 10)
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch∆∞a l·ªçc theo seller

### 5. **Qu·∫£n l√Ω M√£ gi·∫£m gi√° (Coupons)**
- ‚úÖ Xem danh s√°ch m√£ gi·∫£m gi√°
- ‚úÖ T·∫°o m√£ gi·∫£m gi√° m·ªõi
- ‚úÖ Ch·ªânh s·ª≠a m√£ gi·∫£m gi√°
- ‚úÖ X√≥a m√£ gi·∫£m gi√°
- ‚úÖ Qu·∫£n l√Ω tr·∫°ng th√°i active/inactive
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch∆∞a c√≥ c·ªôt `SellerId` trong b·∫£ng `Coupons` ƒë·ªÉ li√™n k·∫øt v·ªõi seller

### 6. **Qu·∫£n l√Ω ƒê√°nh gi√° (Reviews)**
- ‚úÖ Xem danh s√°ch ƒë√°nh gi√° s·∫£n ph·∫©m
- ‚úÖ Ph√™ duy·ªát ƒë√°nh gi√°
- ‚úÖ T·ª´ ch·ªëi ƒë√°nh gi√°
- ‚úÖ Th·ªëng k√™ ƒë√°nh gi√° (t·ªïng s·ªë, trung b√¨nh rating, ph√¢n b·ªë rating)
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch∆∞a l·ªçc theo s·∫£n ph·∫©m c·ªßa seller

### 7. **B√°o c√°o Doanh thu (Sales)**
- ‚úÖ Xem doanh thu theo kho·∫£ng th·ªùi gian
- ‚úÖ Xem s·ªë l∆∞·ª£ng ƒë∆°n h√†ng
- ‚úÖ Bi·ªÉu ƒë·ªì doanh thu theo ng√†y
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch∆∞a l·ªçc theo seller

### 8. **Analytics (Ph√¢n t√≠ch)**
- ‚úÖ Top s·∫£n ph·∫©m b√°n ch·∫°y
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch·ª©c nƒÉng ch∆∞a ho√†n ch·ªânh, c·∫ßn b·ªï sung th√™m metrics

### 9. **Qu·∫£n l√Ω Th√¥ng b√°o (Notifications)**
- ‚úÖ Xem danh s√°ch th√¥ng b√°o
- ‚úÖ ƒê√°nh d·∫•u ƒë√£ ƒë·ªçc
- ‚úÖ ƒê√°nh d·∫•u t·∫•t c·∫£ ƒë√£ ƒë·ªçc
- ‚úÖ L·ªçc theo lo·∫°i th√¥ng b√°o
- ‚úÖ Hi·ªÉn th·ªã s·ªë l∆∞·ª£ng th√¥ng b√°o ch∆∞a ƒë·ªçc

### 10. **Qu·∫£n l√Ω Hoa h·ªìng (Commissions)**
- ‚úÖ Xem t·ªïng doanh thu v√† hoa h·ªìng
- ‚úÖ Xem b√°o c√°o hoa h·ªìng theo th√°ng
- ‚úÖ Xem t·ª∑ l·ªá hoa h·ªìng (15%)
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch∆∞a l·ªçc theo seller

### 11. **Qu·∫£n l√Ω Kh√°ch h√†ng (Customers)**
- ‚úÖ Xem danh s√°ch kh√°ch h√†ng
- ‚úÖ Xem top kh√°ch h√†ng theo doanh thu
- ‚úÖ Xem kh√°ch h√†ng m·ªõi
- ‚úÖ Th·ªëng k√™ kh√°ch h√†ng
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch∆∞a l·ªçc theo kh√°ch h√†ng ƒë√£ mua s·∫£n ph·∫©m c·ªßa seller

### 12. **B√°o c√°o T·ªïng h·ª£p (Reports)**
- ‚úÖ B√°o c√°o doanh thu t·ªïng h·ª£p
- ‚úÖ Bi·ªÉu ƒë·ªì doanh thu 7 ng√†y g·∫ßn nh·∫•t
- ‚úÖ Bi·ªÉu ƒë·ªì ƒë∆°n h√†ng 7 ng√†y g·∫ßn nh·∫•t
- ‚úÖ Th·ªëng k√™ s·∫£n ph·∫©m, kh√°ch h√†ng
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch∆∞a l·ªçc theo seller

### 13. **Hi·ªáu su·∫•t S·∫£n ph·∫©m (Product Performance)**
- ‚úÖ Xem top s·∫£n ph·∫©m b√°n ch·∫°y
- ‚úÖ Xem s·∫£n ph·∫©m b√°n k√©m
- ‚úÖ Hi·ªÉn th·ªã doanh thu, s·ªë l∆∞·ª£ng b√°n, rating
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: Ch∆∞a l·ªçc theo seller

### 14. **Qu·∫£n l√Ω H·ªì s∆° (Profile)**
- ‚úÖ Xem th√¥ng tin c√° nh√¢n
- ‚úÖ C·∫≠p nh·∫≠t th√¥ng tin:
  - T√™n c√¥ng ty
  - Gi·∫•y ph√©p kinh doanh
  - M√£ s·ªë thu·∫ø
  - ƒê·ªãa ch·ªâ
  - S·ªë ƒëi·ªán tho·∫°i
  - Email
  - H·ªç t√™n

### 15. **C√†i ƒë·∫∑t (Settings)**
- ‚úÖ C√†i ƒë·∫∑t c·ª≠a h√†ng (tr·∫°ng th√°i ho·∫°t ƒë·ªông)
- ‚úÖ C√†i ƒë·∫∑t gi·ªù l√†m vi·ªác
- ‚úÖ C√†i ƒë·∫∑t ng∆∞·ª°ng c·∫£nh b√°o t·ªìn kho
- ‚úÖ C√†i ƒë·∫∑t email th√¥ng b√°o
- ‚ö†Ô∏è **V·∫§N ƒê·ªÄ**: C√°c c√†i ƒë·∫∑t ch∆∞a ƒë∆∞·ª£c l∆∞u v√†o database

### 16. **Qu·∫£n l√Ω C·ª≠a h√†ng (Store Management)**
- ‚úÖ Xem th√¥ng tin c·ª≠a h√†ng
- ‚úÖ Xem t·ªìn kho c·ª≠a h√†ng (StoreInventory)
- ‚úÖ Xem c√†i ƒë·∫∑t c·ª≠a h√†ng (StoreSettings)
- ‚úÖ Xem nh√¢n vi√™n c·ª≠a h√†ng
- ‚úÖ Th·ªëng k√™ c·ª≠a h√†ng
- ‚úÖ C·∫≠p nh·∫≠t t·ªìn kho c·ª≠a h√†ng
- ‚úÖ C·∫≠p nh·∫≠t c√†i ƒë·∫∑t c·ª≠a h√†ng

---

## üö® C√ÅC V·∫§N ƒê·ªÄ C·∫¶N KH·∫ÆC PH·ª§C

### **V·∫•n ƒë·ªÅ 1: Thi·∫øu c·ªôt SellerId trong b·∫£ng Products**
**M√¥ t·∫£**: Hi·ªán t·∫°i b·∫£ng `Products` kh√¥ng c√≥ c·ªôt `SellerId` ƒë·ªÉ li√™n k·∫øt s·∫£n ph·∫©m v·ªõi seller c·ª• th·ªÉ. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác t·∫•t c·∫£ seller c√≥ th·ªÉ th·∫•y v√† qu·∫£n l√Ω T·∫§T C·∫¢ s·∫£n ph·∫©m trong h·ªá th·ªëng.

**Gi·∫£i ph√°p**:
1. Th√™m migration ƒë·ªÉ th√™m c·ªôt `SellerId` v√†o b·∫£ng `Products`
2. C·∫≠p nh·∫≠t model `Product` ƒë·ªÉ bao g·ªìm property `SellerId`
3. C·∫≠p nh·∫≠t t·∫•t c·∫£ queries trong `SellerController` v√† `SellerProductsController` ƒë·ªÉ filter theo `SellerId`

**File c·∫ßn s·ª≠a**:
- `/Models/Product.cs` - Th√™m property `SellerId`
- T·∫°o migration m·ªõi
- `/Controllers/SellerController.cs` - C·∫≠p nh·∫≠t queries
- `/Controllers/SellerProductsController.cs` - C·∫≠p nh·∫≠t queries

### **V·∫•n ƒë·ªÅ 2: Thi·∫øu c·ªôt SellerId trong b·∫£ng Coupons**
**M√¥ t·∫£**: T∆∞∆°ng t·ª± Products, b·∫£ng `Coupons` kh√¥ng c√≥ c·ªôt `SellerId` n√™n t·∫•t c·∫£ seller c√≥ th·ªÉ th·∫•y m√£ gi·∫£m gi√° c·ªßa nhau.

**Gi·∫£i ph√°p**:
1. Th√™m c·ªôt `SellerId` v√†o b·∫£ng `Coupons` (c√≥ th·ªÉ NULL cho coupons c·ªßa h·ªá th·ªëng)
2. Filter coupons theo seller khi hi·ªÉn th·ªã

### **V·∫•n ƒë·ªÅ 3: Dashboard hi·ªÉn th·ªã d·ªØ li·ªáu c·ªßa to√†n h·ªá th·ªëng**
**M√¥ t·∫£**: Method `GetSellerDashboardStats()` hi·ªán t·∫°i ƒëang query to√†n b·ªô products v√† orders thay v√¨ ch·ªâ c·ªßa seller c·ª• th·ªÉ.

**Gi·∫£i ph√°p**: C·∫≠p nh·∫≠t logic trong method n√†y ƒë·ªÉ filter theo `SellerId` sau khi ƒë√£ th√™m c·ªôt `SellerId` v√†o Products.

### **V·∫•n ƒë·ªÅ 4: Orders kh√¥ng filter theo seller**
**M√¥ t·∫£**: Seller hi·ªán c√≥ th·ªÉ xem T·∫§T C·∫¢ ƒë∆°n h√†ng trong h·ªá th·ªëng, kh√¥ng ch·ªâ ƒë∆°n h√†ng c√≥ s·∫£n ph·∫©m c·ªßa m√¨nh.

**Gi·∫£i ph√°p**: 
- Sau khi c√≥ `SellerId` trong Products, c·∫ßn join OrderItems v·ªõi Products ƒë·ªÉ ch·ªâ hi·ªÉn th·ªã orders c√≥ ch·ª©a s·∫£n ph·∫©m c·ªßa seller hi·ªán t·∫°i

### **V·∫•n ƒë·ªÅ 5: Settings kh√¥ng ƒë∆∞·ª£c persist v√†o database**
**M√¥ t·∫£**: Trong method `Settings()`, c√°c c√†i ƒë·∫∑t ch·ªâ ƒë∆∞·ª£c hi·ªÉn th·ªã hardcode, kh√¥ng l∆∞u v√†o database.

**Gi·∫£i ph√°p**:
- T·∫°o b·∫£ng `SellerSettings` ho·∫∑c s·ª≠ d·ª•ng b·∫£ng `StoreSettings` hi·ªán c√≥
- L∆∞u v√† load settings t·ª´ database

### **V·∫•n ƒë·ªÅ 6: Analytics ch∆∞a ho√†n ch·ªânh**
**M√¥ t·∫£**: Method `Analytics()` ch·ªâ c√≥ top products, thi·∫øu nhi·ªÅu metrics quan tr·ªçng.

**Gi·∫£i ph√°p**: B·ªï sung th√™m:
- T·ª∑ l·ªá conversion
- Traffic sources
- Customer retention rate
- Revenue growth rate
- Product categories performance

### **V·∫•n ƒë·ªÅ 7: Thi·∫øu validation v√† error handling**
**M√¥ t·∫£**: Nhi·ªÅu methods thi·∫øu validation ƒë·∫ßu v√†o v√† error handling ƒë·∫ßy ƒë·ªß.

**Gi·∫£i ph√°p**:
- Th√™m try-catch blocks
- Validate input parameters
- Return proper error messages

---

## üîß DANH S√ÅCH C√îNG VI·ªÜC C·∫¶N TH·ª∞C HI·ªÜN

### **PHASE 1: Database Schema Updates (∆Øu ti√™n cao)**

#### 1.1. Th√™m SellerId v√†o Products
```csharp
// File: /Models/Product.cs
public class Product
{
    // ... existing properties ...
    
    [MaxLength(450)]
    public string? SellerId { get; set; }
    
    [ForeignKey("SellerId")]
    public ApplicationUser? Seller { get; set; }
}
```

#### 1.2. T·∫°o Migration
```bash
dotnet ef migrations add AddSellerIdToProducts
dotnet ef database update
```

#### 1.3. Th√™m SellerId v√†o Coupons
```csharp
// File: /Models/Coupon.cs
[MaxLength(450)]
public string? SellerId { get; set; }  // NULL = system-wide coupon

[ForeignKey("SellerId")]
public ApplicationUser? Seller { get; set; }
```

#### 1.4. T·∫°o b·∫£ng SellerSettings
```csharp
public class SellerSettings
{
    public Guid Id { get; set; }
    public string SellerId { get; set; } = string.Empty;
    public string SettingKey { get; set; } = string.Empty;
    public string SettingValue { get; set; } = string.Empty;
    public string? Description { get; set; }
    public DateTime UpdatedAt { get; set; } = DateTime.UtcNow;
    
    [ForeignKey("SellerId")]
    public ApplicationUser Seller { get; set; } = null!;
}
```

### **PHASE 2: Controller Updates (∆Øu ti√™n cao)**

#### 2.1. C·∫≠p nh·∫≠t SellerController.cs
S·ª≠a t·∫•t c·∫£ c√°c TODO comments:

**Dashboard:**
```csharp
private async Task<SellerDashboardViewModel> GetSellerDashboardStats(string sellerId)
{
    var myProductsCount = await _context.Products
        .Where(p => p.SellerId == sellerId)
        .CountAsync();
    
    var myProductIds = await _context.Products
        .Where(p => p.SellerId == sellerId)
        .Select(p => p.Id)
        .ToListAsync();
    
    var myOrders = await _context.OrderItems
        .Include(oi => oi.Order)
        .Where(oi => myProductIds.Contains(oi.ProductId) && 
                     oi.Order.Status == "completed")
        .Select(oi => oi.Order)
        .Distinct()
        .ToListAsync();
    
    // ... rest of logic
}
```

**Inventory:**
```csharp
[HttpGet("inventory")]
public async Task<IActionResult> Inventory(string search = "", bool lowStock = false)
{
    var currentUser = await _userManager.GetUserAsync(User);
    
    var query = _context.Products
        .Include(p => p.Category)
        .Include(p => p.Brand)
        .Where(p => p.SellerId == currentUser.Id);  // FIXED: Filter by seller
    
    // ... rest of logic
}
```

**Orders:**
```csharp
[HttpGet("orders")]
public async Task<IActionResult> Orders(...)
{
    var currentUser = await _userManager.GetUserAsync(User);
    
    var myProductIds = await _context.Products
        .Where(p => p.SellerId == currentUser.Id)
        .Select(p => p.Id)
        .ToListAsync();
    
    var query = _context.OrderItems
        .Include(oi => oi.Order)
        .ThenInclude(o => o.User)
        .Where(oi => myProductIds.Contains(oi.ProductId))
        .Select(oi => oi.Order)
        .Distinct();
    
    // ... rest of logic
}
```

#### 2.2. C·∫≠p nh·∫≠t SellerProductsController.cs
```csharp
[HttpGet("")]
public async Task<IActionResult> Index(...)
{
    var currentUserId = User.FindFirstValue(ClaimTypes.NameIdentifier);
    
    var query = _context.Products
        .Include(p => p.Category)
        .Include(p => p.Brand)
        .Where(p => p.SellerId == currentUserId);  // FIXED: Filter by seller
    
    // ... rest of logic
}

[HttpPost("create")]
public async Task<IActionResult> Create(Product product, IFormFile? imageFile)
{
    if (ModelState.IsValid)
    {
        var currentUserId = User.FindFirstValue(ClaimTypes.NameIdentifier);
        product.SellerId = currentUserId;  // FIXED: Set seller ID
        
        // ... rest of logic
    }
}
```

### **PHASE 3: ViewModels Updates**

#### 3.1. Th√™m ViewModels c√≤n thi·∫øu v√†o AdminViewModels.cs

```csharp
// Coupon Management ViewModels
public class CouponManagementViewModel
{
    public List<CouponItem> Coupons { get; set; } = new();
    public int CurrentPage { get; set; }
    public int TotalPages { get; set; }
    public int PageSize { get; set; }
    public string Search { get; set; } = string.Empty;
    public string Status { get; set; } = string.Empty;
    public int TotalCount { get; set; }
}

public class CouponItem
{
    public Guid Id { get; set; }
    public string Code { get; set; } = string.Empty;
    public string Name { get; set; } = string.Empty;
    public string Type { get; set; } = string.Empty;
    public decimal Value { get; set; }
    public decimal? MinOrderAmount { get; set; }
    public int? UsageLimit { get; set; }
    public int UsageCount { get; set; }
    public DateTime? StartDate { get; set; }
    public DateTime? EndDate { get; set; }
    public bool IsActive { get; set; }
}

public class CouponCreateEditViewModel
{
    public Guid Id { get; set; }
    
    [Required]
    [StringLength(50)]
    public string Code { get; set; } = string.Empty;
    
    [StringLength(500)]
    public string Description { get; set; } = string.Empty;
    
    [Required]
    public string DiscountType { get; set; } = "percentage"; // percentage, fixed
    
    [Required]
    [Range(0, double.MaxValue)]
    public decimal DiscountValue { get; set; }
    
    [Range(0, double.MaxValue)]
    public decimal MinOrderAmount { get; set; }
    
    public int? UsageLimit { get; set; }
    
    [Required]
    public DateTime ExpiryDate { get; set; } = DateTime.Now.AddDays(30);
    
    public bool IsActive { get; set; } = true;
}

// Reviews ViewModels
public class SellerReviewsViewModel
{
    public List<ProductReview> Reviews { get; set; } = new();
    public int CurrentPage { get; set; }
    public int TotalPages { get; set; }
    public int PageSize { get; set; }
    public string Search { get; set; } = string.Empty;
    public int? Rating { get; set; }
    public string Status { get; set; } = string.Empty;
    public int TotalCount { get; set; }
    public ReviewStatistics Statistics { get; set; } = new();
}

public class ReviewStatistics
{
    public int TotalReviews { get; set; }
    public int ApprovedReviews { get; set; }
    public int PendingReviews { get; set; }
    public int RejectedReviews { get; set; }
    public double AverageRating { get; set; }
    public Dictionary<int, int> RatingDistribution { get; set; } = new();
}

// Notifications ViewModels
public class SellerNotificationsViewModel
{
    public List<Notification> Notifications { get; set; } = new();
    public int CurrentPage { get; set; }
    public int TotalPages { get; set; }
    public int PageSize { get; set; }
    public string Type { get; set; } = string.Empty;
    public bool? IsRead { get; set; }
    public int TotalCount { get; set; }
    public int UnreadCount { get; set; }
}

// Commissions ViewModels
public class SellerCommissionsViewModel
{
    public DateTime FromDate { get; set; }
    public DateTime ToDate { get; set; }
    public decimal TotalSales { get; set; }
    public decimal TotalCommission { get; set; }
    public int TotalOrders { get; set; }
    public decimal CommissionRate { get; set; }
    public List<MonthlyCommissionData> MonthlyData { get; set; } = new();
    public List<RecentOrder> RecentOrders { get; set; } = new();
}

public class MonthlyCommissionData
{
    public int Month { get; set; }
    public int Year { get; set; }
    public decimal Sales { get; set; }
    public decimal Commission { get; set; }
    public int OrderCount { get; set; }
}

// Customers ViewModels
public class SellerCustomersViewModel
{
    public List<CustomerInfo> Customers { get; set; } = new();
    public List<CustomerInfo> TopCustomers { get; set; } = new();
    public List<CustomerInfo> NewCustomers { get; set; } = new();
    public int CurrentPage { get; set; }
    public int TotalPages { get; set; }
    public int PageSize { get; set; }
    public string Search { get; set; } = string.Empty;
    public int TotalCount { get; set; }
}

public class CustomerInfo
{
    public string UserId { get; set; } = string.Empty;
    public string FullName { get; set; } = string.Empty;
    public string Email { get; set; } = string.Empty;
    public string Phone { get; set; } = string.Empty;
    public DateTime FirstOrderDate { get; set; }
    public DateTime LastOrderDate { get; set; }
    public int TotalOrders { get; set; }
    public decimal TotalSpent { get; set; }
    public decimal AverageOrderValue { get; set; }
    public string Status { get; set; } = string.Empty; // Active, Inactive
}

// Reports ViewModels
public class SellerReportsViewModel
{
    public decimal TotalRevenue { get; set; }
    public decimal MonthlyRevenue { get; set; }
    public int TotalOrders { get; set; }
    public int MonthlyOrders { get; set; }
    public int TotalProducts { get; set; }
    public int ActiveProducts { get; set; }
    public int TotalCustomers { get; set; }
    public int NewCustomers { get; set; }
    public decimal AverageOrderValue { get; set; }
    public decimal ConversionRate { get; set; }
    public List<string> SalesChartLabels { get; set; } = new();
    public List<decimal> SalesChartData { get; set; } = new();
    public List<string> OrdersChartLabels { get; set; } = new();
    public List<int> OrdersChartData { get; set; } = new();
    public DateTime FromDate { get; set; }
    public DateTime ToDate { get; set; }
}

// Product Performance ViewModels
public class SellerProductPerformanceViewModel
{
    public List<ProductPerformanceItem> TopProducts { get; set; } = new();
    public List<ProductPerformanceItem> LowPerformingProducts { get; set; } = new();
    public DateTime FromDate { get; set; }
    public DateTime ToDate { get; set; }
}

public class ProductPerformanceItem
{
    public Guid ProductId { get; set; }
    public string ProductName { get; set; } = string.Empty;
    public string ImageUrl { get; set; } = string.Empty;
    public decimal Price { get; set; }
    public int TotalSold { get; set; }
    public decimal Revenue { get; set; }
    public int ReviewCount { get; set; }
    public double AverageRating { get; set; }
}

// Store Management ViewModels
public class StoreManagementViewModel
{
    public Store? Store { get; set; }
    public List<StoreInventoryItem> Inventory { get; set; } = new();
    public List<StoreSettingItem> Settings { get; set; } = new();
    public StoreStatistics Statistics { get; set; } = new();
    public List<SellerStore> StoreStaff { get; set; } = new();
}

public class StoreInventoryItem
{
    public Guid Id { get; set; }
    public string ProductName { get; set; } = string.Empty;
    public string ProductImageUrl { get; set; } = string.Empty;
    public string ProductSku { get; set; } = string.Empty;
    public int Quantity { get; set; }
    public int MinimumStock { get; set; }
    public int MaximumStock { get; set; }
    public string? Location { get; set; }
    public DateTime LastUpdated { get; set; }
}

public class StoreSettingItem
{
    public Guid Id { get; set; }
    public string SettingKey { get; set; } = string.Empty;
    public string SettingValue { get; set; } = string.Empty;
    public string? Description { get; set; }
    public DateTime UpdatedAt { get; set; }
    public string UpdatedByName { get; set; } = string.Empty;
}

public class StoreStatistics
{
    public int TotalProducts { get; set; }
    public int LowStockProducts { get; set; }
    public int OutOfStockProducts { get; set; }
    public decimal TotalInventoryValue { get; set; }
    public int StaffCount { get; set; }
    public decimal MonthlyRevenue { get; set; }
    public int MonthlyOrders { get; set; }
}

public class StoreSettingsViewModel
{
    public Guid StoreId { get; set; }
    
    [Required]
    [StringLength(255)]
    public string StoreName { get; set; } = string.Empty;
    
    [Required]
    [StringLength(500)]
    public string StoreAddress { get; set; } = string.Empty;
    
    [StringLength(50)]
    public string? Phone { get; set; }
    
    [EmailAddress]
    [StringLength(255)]
    public string? Email { get; set; }
    
    [StringLength(255)]
    public string? Website { get; set; }
    
    [StringLength(100)]
    public string? WorkingHours { get; set; }
    
    [StringLength(500)]
    public string? Description { get; set; }
    
    [StringLength(100)]
    public string? SocialMedia { get; set; }
    
    public bool IsActive { get; set; } = true;
    
    public Dictionary<string, string> AdditionalSettings { get; set; } = new();
}

// Seller Settings ViewModels
public class SellerSettingsViewModel
{
    public bool IsStoreActive { get; set; }
    public TimeSpan BusinessHoursStart { get; set; }
    public TimeSpan BusinessHoursEnd { get; set; }
    public string ReportFrequency { get; set; } = "Weekly"; // Daily, Weekly, Monthly
    public int LowStockThreshold { get; set; }
    public EmailNotificationSettings EmailNotifications { get; set; } = new();
    public int TotalProducts { get; set; }
    public int TotalOrders { get; set; }
}

public class EmailNotificationSettings
{
    public bool NewOrders { get; set; }
    public bool LowStock { get; set; }
    public bool ProductReviews { get; set; }
    public bool SystemUpdates { get; set; }
}

// Seller Profile ViewModels
public class SellerProfileViewModel
{
    [Required]
    [StringLength(255)]
    public string CompanyName { get; set; } = string.Empty;
    
    [StringLength(100)]
    public string BusinessLicense { get; set; } = string.Empty;
    
    [StringLength(50)]
    public string TaxCode { get; set; } = string.Empty;
    
    [StringLength(500)]
    public string Address { get; set; } = string.Empty;
    
    [Phone]
    [StringLength(20)]
    public string Phone { get; set; } = string.Empty;
    
    [Required]
    [EmailAddress]
    [StringLength(255)]
    public string Email { get; set; } = string.Empty;
    
    [Required]
    [StringLength(100)]
    public string FirstName { get; set; } = string.Empty;
    
    [Required]
    [StringLength(100)]
    public string LastName { get; set; } = string.Empty;
    
    public bool IsApproved { get; set; }
    public DateTime? ApprovedAt { get; set; }
    public string? Notes { get; set; }
    public DateTime CreatedAt { get; set; }
    public DateTime UpdatedAt { get; set; }
    public bool IsActive { get; set; }
}

// Sales ViewModels
public class SellerSalesViewModel
{
    public DateTime FromDate { get; set; }
    public DateTime ToDate { get; set; }
    public decimal TotalRevenue { get; set; }
    public int TotalOrders { get; set; }
    public List<DailySales> SalesData { get; set; } = new();
}

public class DailySales
{
    public DateTime Date { get; set; }
    public decimal Revenue { get; set; }
    public int OrderCount { get; set; }
}

// Analytics ViewModels
public class SellerAnalyticsViewModel
{
    public List<TopSellingProduct> TopProducts { get; set; } = new();
    // TODO: Add more analytics metrics
}

// Inventory ViewModels
public class InventoryListViewModel
{
    public List<InventoryItemViewModel> Items { get; set; } = new();
    public string SearchTerm { get; set; } = string.Empty;
    public string Filter { get; set; } = "all"; // all, low_stock, out_of_stock
}

public class InventoryItemViewModel
{
    public Guid Id { get; set; }
    public Guid ProductId { get; set; }
    public string ProductName { get; set; } = string.Empty;
    public string SKU { get; set; } = string.Empty;
    public int CurrentStock { get; set; }
    public string CategoryName { get; set; } = string.Empty;
    public decimal Price { get; set; }
    public DateTime LastUpdated { get; set; }
}
```

### **PHASE 4: View Updates**

Ki·ªÉm tra v√† c·∫≠p nh·∫≠t c√°c views trong `/Views/Seller/` ƒë·ªÉ ƒë·∫£m b·∫£o:
- Hi·ªÉn th·ªã ƒë√∫ng d·ªØ li·ªáu t·ª´ ViewModels
- Form validation ho·∫°t ƒë·ªông ƒë√∫ng
- UI responsive v√† user-friendly
- Error messages hi·ªÉn th·ªã ƒë·∫ßy ƒë·ªß

### **PHASE 5: Testing**

#### 5.1. Unit Tests
- Test t·∫•t c·∫£ methods trong SellerController
- Test authorization (ch·ªâ seller m·ªõi ƒë∆∞·ª£c truy c·∫≠p)
- Test filtering theo SellerId

#### 5.2. Integration Tests
- Test to√†n b·ªô flow t·ª´ login -> dashboard -> qu·∫£n l√Ω s·∫£n ph·∫©m/ƒë∆°n h√†ng
- Test upload images
- Test payment flows

#### 5.3. Manual Testing Checklist
- [ ] Login v·ªõi t√†i kho·∫£n seller
- [ ] Dashboard hi·ªÉn th·ªã ƒë√∫ng d·ªØ li·ªáu c·ªßa seller
- [ ] T·∫°o s·∫£n ph·∫©m m·ªõi (c√≥ upload ·∫£nh)
- [ ] Ch·ªânh s·ª≠a s·∫£n ph·∫©m
- [ ] X√≥a s·∫£n ph·∫©m
- [ ] Xem danh s√°ch ƒë∆°n h√†ng (ch·ªâ c·ªßa seller)
- [ ] C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng
- [ ] Qu·∫£n l√Ω t·ªìn kho
- [ ] T·∫°o/s·ª≠a/x√≥a m√£ gi·∫£m gi√°
- [ ] Xem v√† ph√™ duy·ªát ƒë√°nh gi√°
- [ ] Xem b√°o c√°o doanh thu
- [ ] Xem th√¥ng b√°o
- [ ] C·∫≠p nh·∫≠t h·ªì s∆°
- [ ] C·∫≠p nh·∫≠t c√†i ƒë·∫∑t

---

## üìä METRICS C·∫¶N TRACK

### KPIs cho Seller Dashboard:
1. **Revenue Metrics**
   - Total revenue
   - Monthly revenue
   - Revenue growth rate (MoM, YoY)
   - Average order value

2. **Product Metrics**
   - Total products
   - Active products
   - Out of stock products
   - Low stock alerts
   - Top selling products

3. **Order Metrics**
   - Total orders
   - Pending orders
   - Completed orders
   - Cancelled orders
   - Order fulfillment rate

4. **Customer Metrics**
   - Total customers
   - New customers
   - Repeat customers
   - Customer retention rate
   - Customer lifetime value

5. **Performance Metrics**
   - Conversion rate
   - Product views
   - Add to cart rate
   - Average rating
   - Review count

---

## üîê SECURITY CONSIDERATIONS

1. **Authorization**
   - ƒê·∫£m b·∫£o seller ch·ªâ c√≥ th·ªÉ truy c·∫≠p d·ªØ li·ªáu c·ªßa m√¨nh
   - Validate seller ownership tr∆∞·ªõc khi cho ph√©p edit/delete
   - Implement proper role-based access control

2. **Input Validation**
   - Validate t·∫•t c·∫£ user inputs
   - Sanitize HTML content
   - Prevent SQL injection
   - Prevent XSS attacks

3. **File Upload Security**
   - Validate file types
   - Limit file sizes
   - Scan for malware
   - Use secure file naming

4. **API Security**
   - Implement rate limiting
   - Use HTTPS only
   - Validate API tokens
   - Log all API calls

---

## üìù DOCUMENTATION

### User Documentation
C·∫ßn t·∫°o c√°c t√†i li·ªáu h∆∞·ªõng d·∫´n:
1. **Seller Getting Started Guide**
2. **Product Management Guide**
3. **Order Management Guide**
4. **Reports & Analytics Guide**
5. **FAQ for Sellers**

### Technical Documentation
1. **API Documentation**
2. **Database Schema Documentation**
3. **Deployment Guide**
4. **Troubleshooting Guide**

---

## üéâ NEXT STEPS

1. ‚úÖ ƒê·ªçc v√† hi·ªÉu t√†i li·ªáu n√†y
2. ‚¨ú T·∫°o branch m·ªõi: `feature/seller-improvements`
3. ‚¨ú Implement Phase 1: Database updates
4. ‚¨ú Implement Phase 2: Controller updates
5. ‚¨ú Implement Phase 3: ViewModel updates
6. ‚¨ú Test t·ª´ng ch·ª©c nƒÉng
7. ‚¨ú Code review
8. ‚¨ú Merge v√†o main branch
9. ‚¨ú Deploy l√™n production

---

## üìû H·ªñ TR·ª¢

N·∫øu c√≥ v·∫•n ƒë·ªÅ trong qu√° tr√¨nh implement, vui l√≤ng:
1. Ki·ªÉm tra l·∫°i t√†i li·ªáu n√†y
2. Xem logs trong `/logs/`
3. Ki·ªÉm tra database schema
4. Li√™n h·ªá team lead

---

**Ng√†y c·∫≠p nh·∫≠t cu·ªëi**: 10/11/2025
**Ng∆∞·ªùi t·∫°o**: GitHub Copilot
**Version**: 1.0
